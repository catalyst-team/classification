model_params:
  model: MultiHeadNetAE
  mode: "ae"
  encoder_params:
    z_dim: &z_dim 16
  decoder_params:
    z_dim: *z_dim
#  encoder_params:
#    arch: resnet18
#    pretrained: True
#    frozen: True
#    pooling: MaxPool2d
#    pooling_kwargs:
#      kernel_size: 7      # [14, 7]
#      stride: 7           # [14, 7]
#  embedding_net_params:
#    hiddens: [512, 512]
#    activation_fn: ReLU
#    norm_fn: BatchNorm1d
#    bias: false
#    dropout: 0.5
#    residual: "soft"

stages:

  # train head
#  stage1:
#    state_params:
#      num_epochs: 16
#
#    optimizer_params:
#      optimizer: Adam
#      lr: 0.001
#      weight_decay: 0.0001
#
#    scheduler_params:
#      scheduler: MultiStepLR
#      milestones: [8]
#      gamma: 0.3

  # tune whole network
  stage2:
    state_params:
      num_epochs: 120

    optimizer_params:
      optimizer: Adam
      lr: 0.001

    scheduler_params:
      scheduler: MultiStepLR
      milestones: [30, 75, 105]
      gamma: 0.3